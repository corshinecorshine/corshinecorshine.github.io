I"Ý%<blockquote>
  <p><strong>The information provided in this site is for educational purposes regarding pentesting. The author of the site will not be held any responsibility for any misuse of the information from this site.</strong></p>
</blockquote>

<h2 id="summary"><strong><span style="color:#ff5555">Summary</span></strong></h2>
<hr />

<ul>
  <li>Robots.txt gives special <code class="language-plaintext highlighter-rouge">directory</code>.</li>
  <li>Open the directory and get the files.</li>
  <li>Get the files from <code class="language-plaintext highlighter-rouge">FTP</code>.</li>
  <li>Bruteforce the <code class="language-plaintext highlighter-rouge">credentials</code>.</li>
  <li>Login into the website.</li>
  <li>Upload <code class="language-plaintext highlighter-rouge">php</code> reverse shell.</li>
  <li>Capture user.txt.</li>
  <li>Escalate to other <code class="language-plaintext highlighter-rouge">user</code>.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">linpeas</code>.</li>
  <li>Edit the script that being executed with <code class="language-plaintext highlighter-rouge">crontab</code>.</li>
  <li>Rooted.</li>
</ul>

<h2 id="port-scan"><strong><span style="color:#ff5555">Port Scan</span></strong></h2>
<hr />

<p>We found several ports are open, <code class="language-plaintext highlighter-rouge">21,22 and 80</code>.</p>

<p><img src="/images/thm/tartarus/nmap.png" alt="" /></p>

<h2 id="check-the-website"><strong><span style="color:#ff5555">Check the website</span></strong></h2>
<hr />

<p>By checking the website, it gives us default <strong>apache</strong> page, manual search <code class="language-plaintext highlighter-rouge">robots.txt</code> shows interesting information.</p>

<p><img src="/images/thm/tartarus/robots.png" alt="" /></p>

<p><img src="/images/thm/tartarus/website.png" alt="" /></p>

<hr />

<p>It tells us a hint which there is another directory, letâ€™s check the directory.</p>

<p><img src="/images/thm/tartarus/admindir.png" alt="" /></p>

<hr />

<p>We found there are 2 credentials which potentially needs to be <code class="language-plaintext highlighter-rouge">bruteforced</code> in order to login.
I used command <code class="language-plaintext highlighter-rouge">wget</code> to download those files to my machine.</p>

<p><img src="/images/thm/tartarus/creds.png" alt="" /></p>

<h2 id="ftp"><strong><span style="color:#ff5555">FTP</span></strong></h2>
<hr />

<p>Because we still donâ€™t know what is the purposes of these credentials, I decided to check <code class="language-plaintext highlighter-rouge">FTP</code> with anonymous login.</p>

<p><img src="/images/thm/tartarus/ftp2.png" alt="" /></p>

<hr />

<p>There is a file from <code class="language-plaintext highlighter-rouge">FTP</code> that shows us a special directory</p>

<p><img src="/images/thm/tartarus/isi.png" alt="" /></p>

<h2 id="bruteforce-the-credentials"><strong><span style="color:#ff5555">Bruteforce the credentials</span></strong></h2>
<hr />

<p><img src="/images/thm/tartarus/loginform.png" alt="" /></p>

<hr />

<p>It brought us to login form which now makes sense that we need to bruteforce the credentials to login.
I decided to use <code class="language-plaintext highlighter-rouge">hydra</code> to bruteforce the login forms.</p>

<p><img src="/images/thm/tartarus/hydra.png" alt="" /></p>

<h2 id="reverse-shell"><strong><span style="color:#ff5555">Reverse shell</span></strong></h2>
<hr />

<p>Now we have the valid credential to login, after successfully login with <code class="language-plaintext highlighter-rouge">enox</code>, we can upload files to the site, which we can abuse with <code class="language-plaintext highlighter-rouge">php-reverse-shell</code>.</p>

<p><img src="/images/thm/tartarus/phprevshell1.png" alt="" /></p>

<hr />

<p>We need to change the IP and PORT, you can check your own <code class="language-plaintext highlighter-rouge">tun0 IP</code> and changed the file name to make it easier.</p>

<p><img src="/images/thm/tartarus/phprevshell2.png" alt="" /></p>

<p><img src="/images/thm/tartarus/changefilephp.png" alt="" /></p>

<hr />

<p>After successfully uploaded our file, we check the directory and yes there is our file being uploaded.</p>

<p><img src="/images/thm/tartarus/confirmfile.png" alt="" /></p>

<hr />

<p>Now we need to open our file in the url bar and donâ€™t forget to set listener with <code class="language-plaintext highlighter-rouge">netcat</code>.</p>

<p><img src="/images/thm/tartarus/revshell1.png" alt="" /></p>

<p><img src="/images/thm/tartarus/nc1.png" alt="" /></p>

<h2 id="capture-usertxt"><strong><span style="color:#ff5555">Capture user.txt</span></strong></h2>
<hr />

<p>We successfully got in as www-data and we can read <strong>user.txt</strong>.</p>

<p><img src="/images/thm/tartarus/usertxt.png" alt="" /></p>

<h2 id="escalate-to-another-user"><strong><span style="color:#ff5555">Escalate to another user</span></strong></h2>
<hr />

<p>By running <code class="language-plaintext highlighter-rouge">sudo -l</code>, we found that user <code class="language-plaintext highlighter-rouge">thirtytwo</code> is able to execute <code class="language-plaintext highlighter-rouge">/var/www/gdb</code> with <strong>sudo</strong>.</p>

<p>We check <code class="language-plaintext highlighter-rouge">gtfobins</code> to see how to escalate to another user with <code class="language-plaintext highlighter-rouge">gdb</code>.</p>

<blockquote>
  <p><a href="https://gtfobins.github.io/gtfobins/gdb/">GTFOBINS - GDB</a></p>
</blockquote>

<p><img src="/images/thm/tartarus/gdb.png" alt="" /></p>

<hr />

<p>We need to execute the command as <code class="language-plaintext highlighter-rouge">thirtytwo</code> because the user has the privilege to execute <code class="language-plaintext highlighter-rouge">gdb</code>.</p>

<p><img src="/images/thm/tartarus/execgdb.png" alt="" /></p>

<hr />

<p>Now we are on <code class="language-plaintext highlighter-rouge">thirtytwo</code>, by running <code class="language-plaintext highlighter-rouge">sudo -l</code> <strong>again</strong>, we found user <code class="language-plaintext highlighter-rouge">d4rckh</code> is able to run <code class="language-plaintext highlighter-rouge">git</code>.</p>

<p>We need to check <code class="language-plaintext highlighter-rouge">gtfobins</code> again to see how to escalate to next user with <code class="language-plaintext highlighter-rouge">git</code>.</p>

<blockquote>
  <p><a href="https://gtfobins.github.io/gtfobins/git/">GTFOBINS - GIT</a></p>
</blockquote>

<p><img src="/images/thm/tartarus/git.png" alt="" /></p>

<hr />

<p>Execute it.</p>

<p><img src="/images/thm/tartarus/execgit.png" alt="" /></p>

<h2 id="get-in-with-ssh"><strong><span style="color:#ff5555">Get in with ssh</span></strong></h2>
<hr />

<p>And now we are on <code class="language-plaintext highlighter-rouge">d4rckh</code>, because we still using <strong>reverse-shell</strong>, and Iâ€™m afraid that we might get laggy or accidentally press <code class="language-plaintext highlighter-rouge">ctrl+c</code>, I decided create a ssh key as <code class="language-plaintext highlighter-rouge">d4rckh</code> and put my <code class="language-plaintext highlighter-rouge">ssh</code> public key on <code class="language-plaintext highlighter-rouge">authorized_keys</code> of <code class="language-plaintext highlighter-rouge">d4rckh</code> so I can ssh to it and not redo the whole things if something bad happens.</p>

<p><img src="/images/thm/tartarus/sshkeygen.png" alt="" /></p>

<hr />

<p>And now we need to echo the public key to <code class="language-plaintext highlighter-rouge">authorized_keys</code>, so we can login directly to <code class="language-plaintext highlighter-rouge">d4rckh</code> without password.</p>

<p><img src="/images/thm/tartarus/echossh.png" alt="" /></p>

<hr />

<p>Now letâ€™s try to ssh as <code class="language-plaintext highlighter-rouge">d4rckh</code>.</p>

<p><img src="/images/thm/tartarus/ssh1.png" alt="" /></p>

<h2 id="enumerate-deeper"><strong><span style="color:#ff5555">Enumerate deeper</span></strong></h2>
<hr />

<p>At this point, I decided to run <code class="language-plaintext highlighter-rouge">linpeas</code> to enumerate deeper and found a python script and surprisingly <code class="language-plaintext highlighter-rouge">crontab</code> is executing.</p>

<p><img src="/images/thm/tartarus/runlinpeas.png" alt="" /></p>

<p><img src="/images/thm/tartarus/vuln1.png" alt="" /></p>

<p><img src="/images/thm/tartarus/vuln2.png" alt="" /></p>

<hr />

<p>We also found port 3306 which running <code class="language-plaintext highlighter-rouge">Mysql</code> but we can ignore it for now and continue to abuse the script that running on <code class="language-plaintext highlighter-rouge">crontab</code>.</p>

<p><img src="/images/thm/tartarus/crontab1.png" alt="" /></p>

<h2 id="escalate-to-root"><strong><span style="color:#ff5555">Escalate to root</span></strong></h2>
<hr />

<p>This is the default script and we are able to edit the script to get root shell.</p>

<p><img src="/images/thm/tartarus/defaultscript.png" alt="" /></p>

<hr />

<p>And after modified the script, I decided to put simeple script and setup the listener with <code class="language-plaintext highlighter-rouge">netcat</code>.</p>

<p>Wait for a while and the listener finally responded with <strong>root shell</strong>.</p>

<p><img src="/images/thm/tartarus/roottxt.png" alt="" /></p>

<hr />

<p><img src="/images/mandatory/pwned.png" alt="" /></p>

<blockquote>
  <p><a href="https://tryhackme.com/room/tartarus">Tartarus - Tryhackme</a></p>
</blockquote>

:ET